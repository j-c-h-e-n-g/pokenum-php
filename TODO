Add a lot more error handling
